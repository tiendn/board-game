(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{5419:function(e,a,t){e.exports=t(5565)},5424:function(e,a,t){},5565:function(e,a,t){"use strict";t.r(a);var n,r=t(0),c=t.n(r),i=t(27),l=t.n(i),o=(t(5424),t(15)),s=t(16),u=t(21),d=t(20),m=t(22),p=t(25),f=t(33),h=t(122),b=t(18),y=t(26),g=3,v=5e3,O={A:"A",B:"B",C:"C",D:"D"},j="B",E={isReveal:!1,isPlaying:!1,isControlLoading:!1,isEndGame:!1,playerCards:{},playerPoints:(n={},Object(y.a)(n,O.A,2e4),Object(y.a)(n,O.B,2e4),Object(y.a)(n,O.C,2e4),Object(y.a)(n,O.D,2e4),n),playerRemain:[O.A,O.B,O.C,O.D],deckId:null,matchNumber:0,cardRemain:52,err:""},C=Object(f.c)({game:function(){var e,a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"start_game":return Object(b.a)({},a,{isReveal:!1,isControlLoading:!0,isPlaying:!0,isEndGame:!1});case"playing_game":return Object(b.a)({},a,{deckId:t.payload,matchNumber:1});case"shuffle_game_start":return Object(b.a)({},a,{isControlLoading:!0});case"shuffle_game_success":return Object(b.a)({},a,{isControlLoading:!1,cardRemain:52});case"shuffle_game_failed":return Object(b.a)({},a,{isControlLoading:!1});case"draw_cards":return Object(b.a)({},a,{isControlLoading:!1,cardRemain:t.payload.cardRemain,playerCards:Object(b.a)({},a.playerCards,Object(y.a)({},a.matchNumber,t.payload.playerCards))});case"reveal_game":return Object(b.a)({},a,{isReveal:!0,playerPoints:t.payload.playerPoints,playerRemain:t.payload.playerRemain});case"next_match":return Object(b.a)({},a,{isReveal:!1,isControlLoading:!0,matchNumber:a.matchNumber+1});case"back_match":return Object(b.a)({},a,{isReveal:!0,isControlLoading:!1,matchNumber:a.matchNumber-1});case"end_game":return Object(b.a)({},a,{isReveal:!0,playerPoints:t.payload.playerPoints,playerRemain:t.payload.playerRemain,isEndGame:!0});case"play_game_again":return Object(b.a)({},E,{playerPoints:(e={},Object(y.a)(e,O.A,2e4),Object(y.a)(e,O.B,2e4),Object(y.a)(e,O.C,2e4),Object(y.a)(e,O.D,2e4),e)});case"show_err":return Object(b.a)({},a,{err:t.payload});case"hide_err":return Object(b.a)({},a,{err:""});default:return a}}}),k=t(5),w=t.n(k),R=t(23),P=t(11),N=function(e){return c.a.createElement(P.i,{variant:"extended",color:e.color,"aria-label":e.ariaLabel,className:"control-button",onClick:function(){return e.onClick()},disabled:e.disabled},e.title)},_=t(31),x=t(124),D=t(17),I=t.n(D),A=t(30),T=t(123),S=t.n(T),L=function(){function e(){Object(o.a)(this,e)}return Object(s.a)(e,null,[{key:"get",value:function(){var e=Object(A.a)(I.a.mark(function e(a){var t,n,r,c=arguments;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=c.length>1&&void 0!==c[1]?c[1]:{},n={timeout:this.TIMEOUT_RESPONSE},e.next=4,S.a.get(a,Object(b.a)({},n,t));case 4:return r=e.sent,e.abrupt("return",r);case 6:case"end":return e.stop()}},e,this)}));return function(a){return e.apply(this,arguments)}}()},{key:"giveDeckCard",value:function(){var a=Object(A.a)(I.a.mark(function a(){var t;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.get("https://deckofcardsapi.com/api/deck/new/shuffle/?deck_count=1");case 2:return t=a.sent,a.abrupt("return",t);case 4:case"end":return a.stop()}},a)}));return function(){return a.apply(this,arguments)}}()},{key:"shuffleDeck",value:function(){var a=Object(A.a)(I.a.mark(function a(t){var n;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.get("https://deckofcardsapi.com/api/deck/".concat(t,"/shuffle/"));case 2:return n=a.sent,a.abrupt("return",n);case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},{key:"drawCards",value:function(){var a=Object(A.a)(I.a.mark(function a(t){var n;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return a.next=2,e.get("https://deckofcardsapi.com/api/deck/".concat(t,"/draw/?count=3"));case 2:return n=a.sent,a.abrupt("return",n);case 4:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()}]),e}();L.TIMEOUT_RESPONSE=1e4;var B=function(){var e=Object(A.a)(I.a.mark(function e(a){var t,n;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,L.giveDeckCard();case 2:t=e.sent,(n=t.data)&&n.success?(a({type:"playing_game",payload:n.deck_id}),a(W())):a(J("Init game failed"));case 5:case"end":return e.stop()}},e)}));return function(a){return e.apply(this,arguments)}}(),G=function(e){return function(){var a=Object(A.a)(I.a.mark(function a(t){var n,r;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return t({type:"shuffle_game_start"}),a.next=3,L.shuffleDeck(e);case 3:n=a.sent,(r=n.data)&&r.success?t({type:"shuffle_game_success"}):(t(J("Shuffle game failed")),t({type:"shuffle_game_failed"}));case 6:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}()},W=function(){return function(e,a){var t=a().game,n=t.deckId,r=t.cardRemain,c=t.playerRemain;if(r<c.length*g)return e(J("Please shuffle the deck, not enough card")),void e(F());for(var i=r-c.length*g,l=[],o=1;o<=c.length;o++){var s=L.drawCards(n);l.push(s)}Promise.all(l).then(function(){var a=Object(A.a)(I.a.mark(function a(t){var r;return I.a.wrap(function(a){for(;;)switch(a.prev=a.next){case 0:return r={},a.next=3,M(t,c);case 3:if(r=a.sent){a.next=8;break}return e(J("Fetch data failed")),e(G(n)),a.abrupt("return");case 8:e({type:"draw_cards",payload:{playerCards:r,cardRemain:i}});case 9:case"end":return a.stop()}},a)}));return function(e){return a.apply(this,arguments)}}())}},F=function(){return{type:"back_match"}},J=function(e){return{type:"show_err",payload:e}},M=function(e,a){return new Promise(function(t,n){var r={};e.forEach(function(e,t){var n=e.data;r[a[t]]=n.cards}),t(r)})},U=function(e,a,t){var n={},r=[],c=-99999999,i=Object(x.a)(a);return new Promise(function(l,o){new Promise(function(t){a.forEach(function(a,t){e[a].forEach(function(e){var t;n[a]||(n[a]=0),n[a]+="ACE"==(t=e.value)?1:"JACK"==t||"QUEEN"==t||"KING"==t?10:parseInt(t,10),n[a]>c&&(c=n[a])})}),t()}).then(function(){a.forEach(function(e,a){c===n[e]&&r.push(e)})}).then(function(){var e=r.length,n=v*(a.length-e)/e;a.forEach(function(e,a){r.indexOf(e)>=0?t[e]+=n:(t[e]-=v,t[e]<v&&(i=i.filter(function(a){return a!==e})))}),l({newPlayerPoints:t,newPlayerRemain:i})})})},K=t(29),Q=t(59),z=t.n(Q),H=Object(K.withStyles)(function(e){return{progress:{margin:2*e.spacing.unit}}})(function(e){var a=e.classes;return c.a.createElement(z.a,{className:a.progress,color:"primary"})}),V=function(e){function a(e){var t;return Object(o.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).state={open:!1},t.handleClose=t.handleClose.bind(Object(R.a)(t)),t.showDialog=t.showDialog.bind(Object(R.a)(t)),t}return Object(m.a)(a,e),Object(s.a)(a,[{key:"showDialog",value:function(){this.setState({open:!0})}},{key:"handleClose",value:function(){this.setState({open:!1})}},{key:"render",value:function(){var e=this,a=this.state.open,t=this.props,n=t.dialogContent,r=t.dialogTitle,i=t.btnCloseTitle,l=t.btnOpenTitle;return c.a.createElement(P.d,{open:a,onClose:this.handleClose,"aria-labelledby":"alert-dialog-title","aria-describedby":"alert-dialog-description"},c.a.createElement(P.h,{id:"alert-dialog-title"},r),c.a.createElement(P.f,null,c.a.createElement(P.g,{id:"alert-dialog-description"},n)),c.a.createElement(P.e,null,c.a.createElement(P.a,{onClick:this.handleClose,color:"primary"},i||"Disagree"),c.a.createElement(P.a,{onClick:function(){e.handleClose(),e.props.onAgree()},color:"primary",autoFocus:!0},l||"Agree")))}}]),a}(c.a.PureComponent),Y=function(e){function a(e){var t;return Object(o.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).dialogRef=void 0,t.onPlay=t.onPlay.bind(Object(R.a)(t)),t.onShuffle=t.onShuffle.bind(Object(R.a)(t)),t.onReveal=t.onReveal.bind(Object(R.a)(t)),t.onDraw=t.onDraw.bind(Object(R.a)(t)),t.shuffle=t.shuffle.bind(Object(R.a)(t)),t}return Object(m.a)(a,e),Object(s.a)(a,[{key:"onDraw",value:function(){var e=this.props,a=e.dispatch;e.deckId;a({type:"next_match"}),a(W())}},{key:"onReveal",value:function(){this.props.dispatch(function(){var e=Object(A.a)(I.a.mark(function e(a,t){var n,r,c,i,l,o,s,u,d;return I.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t(),r=n.game,c=r.playerCards,i=r.matchNumber,l=r.playerRemain,o=r.playerPoints,!c[i]){e.next=9;break}return e.next=5,U(c[i],l,o);case 5:s=e.sent,u=s.newPlayerPoints,d=s.newPlayerRemain,5!==i&&1!==d.length||a({type:"end_game",payload:{playerPoints:u,playerRemain:d}}),a({type:"reveal_game",payload:{playerPoints:u,playerRemain:d}});case 9:case"end":return e.stop()}},e)}));return function(a,t){return e.apply(this,arguments)}}())}},{key:"onShuffle",value:function(){this.dialogRef&&this.dialogRef.showDialog()}},{key:"onPlay",value:function(){var e=this.props,a=e.dispatch;e.deckId;a(function(e){B(e),e({type:"start_game"})})}},{key:"shuffle",value:function(){var e=this.props,a=e.dispatch,t=e.deckId;a(G(t))}},{key:"render",value:function(){var e=this,a=this.props,t=a.isPlaying,n=a.isControlLoading,r=a.isReveal,i=a.cardRemain;return t?n?c.a.createElement(H,null):c.a.createElement("div",null,c.a.createElement("div",{className:"row",style:{justifyContent:"space-between"}},c.a.createElement(N,{title:"Shuffle",color:"primary",ariaLabel:"Shuffle",onClick:this.onShuffle}),c.a.createElement(N,{title:"Reveal",color:"default",ariaLabel:"Reveal",onClick:this.onReveal}),c.a.createElement(N,{disabled:!r,title:"Draw",color:"secondary",ariaLabel:"Draw",onClick:this.onDraw}),c.a.createElement(V,{ref:function(a){return e.dialogRef=a},dialogContent:"All cards will be shuffled",dialogTitle:"Shuffle the deck",onAgree:this.shuffle})),c.a.createElement("p",null,"Number of cards remain: ",i," ")):c.a.createElement(P.m,{title:"Play",placement:"top"},c.a.createElement(P.i,{color:"primary","aria-label":"Play",className:"control-btn",onClick:this.onPlay},c.a.createElement(_.c,null)))}}]),a}(c.a.PureComponent),$=Object(p.b)(function(e){return{isReveal:e.game.isReveal,isPlaying:e.game.isPlaying,isControlLoading:e.game.isControlLoading,deckId:e.game.deckId,cardRemain:e.game.cardRemain}})(Y),q=function(e){function a(){return Object(o.a)(this,a),Object(u.a)(this,Object(d.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this.props,a=e.isReveal,t=e.card;return a?c.a.createElement("img",{src:t.images.png,alt:t.code,className:"card-image"}):c.a.createElement(P.b,{className:"card"},c.a.createElement(P.c,null,c.a.createElement(_.b,null)))}}]),a}(c.a.PureComponent),X=function(e){function a(){return Object(o.a)(this,a),Object(u.a)(this,Object(d.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){var e=this.props,a=e.isReveal,t=e.playerId,n=e.playerCards[e.matchNumber];return n&&n[t]?c.a.createElement("div",{className:"player-container"},c.a.createElement("div",{className:"row"},c.a.createElement(q,{isReveal:a,card:n[t][0]}),c.a.createElement(q,{isReveal:a,card:n[t][1]}),c.a.createElement(q,{isReveal:a,card:n[t][2]})),c.a.createElement("h4",{className:"text-center"},t)):c.a.createElement("div",{className:"player-container"})}}]),a}(c.a.PureComponent),Z=Object(p.b)(function(e){return{isReveal:e.game.isReveal,matchNumber:e.game.matchNumber,playerCards:e.game.playerCards}})(X),ee="#d32f2f",ae=function(e){function a(e){var t;return Object(o.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).onClose=t.onClose.bind(Object(R.a)(t)),t}return Object(m.a)(a,e),Object(s.a)(a,[{key:"onClose",value:function(){this.props.dispatch({type:"hide_err"})}},{key:"render",value:function(){var e=this.props.err;return c.a.createElement(P.k,{anchorOrigin:{vertical:"bottom",horizontal:"left"},open:""!==e,autoHideDuration:3e3,onClose:this.onClose},c.a.createElement(P.l,{"aria-describedby":"client-snackbar",message:c.a.createElement("span",{id:"client-snackbar"},c.a.createElement(_.d,{style:{paddingRight:10}}),e),action:[c.a.createElement(P.j,{key:"close","aria-label":"Close",color:"inherit",onClick:this.onClose},c.a.createElement(_.a,null))],style:{backgroundColor:ee}}))}}]),a}(c.a.Component),te=Object(p.b)(function(e){return{err:e.game.err}})(ae),ne=Object(p.b)(function(e){return{isPlaying:e.game.isPlaying,currentPlayerPoints:Object.assign({},e.game.playerPoints),matchNumber:e.game.matchNumber}})(function(e){var a=e.currentPlayerPoints,t=e.isPlaying,n=e.matchNumber;return t?c.a.createElement("div",{id:"score-table"},c.a.createElement("div",{className:"text-center"},"GAME: ",n),c.a.createElement("div",null,c.a.createElement("div",null,"A: ",c.a.createElement("span",{className:"text-30"},a[O.A])," points"),c.a.createElement("div",null,"B: ",c.a.createElement("span",{className:"text-30"},a[O.B])," points"),c.a.createElement("div",null,"C: ",c.a.createElement("span",{className:"text-30"},a[O.C])," points"),c.a.createElement("div",null,"D: ",c.a.createElement("span",{className:"text-30"},a[O.D])," points"))):null}),re=function(e){function a(e){var t;return Object(o.a)(this,a),(t=Object(u.a)(this,Object(d.a)(a).call(this,e))).dialogRef=void 0,t.state={dialogTitle:"",dialogContent:""},t.playAgain=t.playAgain.bind(Object(R.a)(t)),t}return Object(m.a)(a,e),Object(s.a)(a,[{key:"componentWillReceiveProps",value:function(e){5===e.matchNumber&&e.isEndGame&&this.getWinnerInformation()}},{key:"getWinnerInformation",value:function(){var e,a,t=this,n=this.props.playerPoints,r=-999999,c="";Object.keys(n).forEach(function(e){n[e]>r&&(r=n[e],c=e)}),a=c===j?"VICTORY":"DEFEAT",e="The winner have ".concat(r," points"),this.setState({dialogTitle:a,dialogContent:e},function(){t.dialogRef&&t.dialogRef.showDialog()})}},{key:"playAgain",value:function(){this.props.dispatch({type:"play_game_again"})}},{key:"render",value:function(){var e=this,a=this.state,t=a.dialogContent,n=a.dialogTitle;return c.a.createElement(V,{ref:function(a){return e.dialogRef=a},dialogContent:t,dialogTitle:n,btnOpenTitle:"Play again",btnCloseTitle:"Quit",onAgree:this.playAgain})}}]),a}(c.a.PureComponent),ce=Object(p.b)(function(e){return{matchNumber:e.game.matchNumber,playerPoints:e.game.playerPoints,isEndGame:e.game.isEndGame}})(re),ie=function(e){function a(){return Object(o.a)(this,a),Object(u.a)(this,Object(d.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){return c.a.createElement("div",{className:"container"},c.a.createElement("div",{id:"game-container"},c.a.createElement(Z,{playerId:O.A}),c.a.createElement("div",{className:w()("row","full-width"),style:{justifyContent:"space-between"}},c.a.createElement(Z,{playerId:O.C}),c.a.createElement($,null),c.a.createElement(Z,{playerId:O.D})),c.a.createElement(Z,{playerId:O.B})),c.a.createElement(te,null),c.a.createElement(ne,null),c.a.createElement(ce,null))}}]),a}(c.a.PureComponent),le=Object(f.a)(h.a),oe=Object(f.d)(C,{},le),se=function(e){function a(){return Object(o.a)(this,a),Object(u.a)(this,Object(d.a)(a).apply(this,arguments))}return Object(m.a)(a,e),Object(s.a)(a,[{key:"render",value:function(){return c.a.createElement(p.a,{store:oe},c.a.createElement(ie,null))}}]),a}(r.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.render(c.a.createElement(se,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})}},[[5419,1,2]]]);
//# sourceMappingURL=main.c60c0b6b.chunk.js.map